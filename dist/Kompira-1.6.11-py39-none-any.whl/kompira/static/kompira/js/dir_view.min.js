(function(kompira){function set_active(active){$(".obj-create").toggleClass("obj-create-focus",active);if(active){var column_name="type";var show_check=$(".column-show-check[name='"+column_name+"']");if(show_check&&!show_check.is(":checked")){show_check.click()}}}$(".obj-create *").on("focus blur",function(e){var is_focus=e.type=="focus";set_active(is_focus)});$(".obj-create #id_name").on("keypress",function(e){var c=String.fromCharCode(e.which);if(c=="#"){$(".obj-create #id_type_id").select2("open");return false}return true}).on("keyup",function(e){var disabled=$(this).val()=="";$(".obj-create .btn").prop("disabled",disabled)}).trigger("keyup");$(".obj-create #id_type_id").on("select2:close",function(e){$(".obj-create #id_name").focus()}).on("select2:focus",function(e){set_active(true)}).on("select2:blur",function(e){set_active(false)});kompira.keybind.on("n",function(){$(".obj-create #id_name").focus()},gettext("create object"),200).on("#",function(){$(".obj-create #id_type_id").select2("open")},gettext("select type object"),201)})(kompira);(function(kompira){$(document).on("rename.kompira",function(e,data){console.log("rename:",data);kompira.dir_action.rename_object(data.abspath,data.new_name)}).on("rename-editing.kompira",function(e,obj_selected){var column_name="name";var row=obj_selected.first();var cell=$("[data-column-name='"+column_name+"']",row);if(cell.length==0){return}var show_check=$(".column-show-check[name='"+column_name+"']");if(show_check&&!show_check.is(":checked")){show_check.click()}if(!cell.is(":visible")){return}if(cell.hasClass("obj-editing")){return}var org_name=row.data("name");var input=$("<textarea>").on("rename-editing-close.kompira",function(e){var $container=$(this).closest(".obj-editing-container");var $cell=$container.data("target-cell");$cell.removeClass("obj-editing");$container.remove()}).on("blur",function(e){$(this).trigger("rename-editing-close.kompira")}).on("keydown",function(e){var $this=$(this);if(e.keyCode==13){var new_name=$this.val();var org_name=$this.data("org_name");if(org_name!=new_name){$(e.target).trigger("rename.kompira",{id:$this.data("id"),abspath:$this.data("abspath"),org_name:org_name,new_name:new_name})}$this.trigger("rename-editing-close.kompira");return false}else if(e.keyCode==27){$this.trigger("rename-editing-close.kompira");return false}return true}).attr({placeholder:org_name}).data({id:row.data("id"),abspath:row.data("abspath"),org_name:org_name}).val(row.data("name"));$("<div>").addClass("obj-editing-container").data("target-cell",cell).appendTo(document.body).append(input);cell.addClass("obj-editing");$(window).trigger("resize");input.focus().select()});$(window).on("resize",function(e){$(".obj-editing-container").each(function(){var $this=$(this);var $cell=$this.data("target-cell");$this.offset($cell.offset()).width($cell.outerWidth()+1).height($cell.outerHeight()+1)})});function rename_object(e,object){var obj_selected;if(object){obj_selected=object}else{obj_selected=$(".obj-cursored");if(obj_selected.length==0){obj_selected=$(".obj-selected");if(obj_selected.length!=1){return}}}$(document).trigger("rename-editing.kompira",[obj_selected])}kompira.dir_object=$.extend({},kompira.dir_object,{rename_object:function(e){var obj_selected=$(".obj-selected");if(obj_selected.length!=1){obj_selected=$(".obj-cursored");if(obj_selected.length==0){return}}rename_object(e,obj_selected)}});kompira.keybind.on("F2",rename_object,gettext("rename object"),500)})(kompira);(function(kompira){function check_selected_objects(){var selected=0;$(".obj-row").each(function(){var row=$(this);var checked=$(".obj-selector",row).is(":checked");row.toggleClass("obj-selected",checked);selected+=checked?1:0});$(document).trigger("select_objects.kompira",selected);return selected}function get_selected_objects(){return $.map($(".obj-selected"),function(row){return $(row).data()})}function get_cursored_object(){return $(".obj-cursored").first().data()}function get_row_by_abspath(abspath){return $('.obj-row[data-abspath="'+abspath+'"]')}function move_cursor_to(row){$(".obj-cursored").removeClass("obj-cursored");if(row.length==1){row.addClass("obj-cursored");var link=$("a.link-object:visible",row);if(link.length==0){link=$("a:visible",row)}link.first().focus()}$(document).trigger("move_cursor.kompira")}function move_cursor_prev(){var cursor=$(".obj-cursored").first().prev();if(cursor.length==0){cursor=$(".obj-row").last()}move_cursor_to(cursor);return cursor}function move_cursor_next(){var cursor=$(".obj-cursored").last().next();if(cursor.length==0){cursor=$(".obj-row").first()}move_cursor_to(cursor);return cursor}function toggle_select(e){var cursor=$(".obj-cursored");if(cursor.length==0){cursor=$(".obj-row").first();move_cursor_to(cursor)}var forward=!e||!(e.shiftKey||e.ctrlKey||e.metaKey);if(forward){cursor.find(".obj-selector").click();move_cursor_next()}else{cursor=move_cursor_prev();cursor.find(".obj-selector").click()}}function toggle_selectall(){$(".obj-selectall").click()}$(".obj-selectall").on("change",function(e){var checked=$(this).is(":checked");$(".obj-selector").not(":disabled").prop("checked",checked);check_selected_objects()});$(".obj-selector").on("change",function(e){check_selected_objects()});$(".obj-row").on("mouseup",function(e){var row=$(this);var selector=row.find(".obj-selector");if(e.target==selector.get(0)){return true}var checked=selector.is(":checked");var select_single=!(e.shiftKey||e.ctrlKey||e.metaKey);if(!checked&&select_single){$(".obj-selector").not(":disabled").prop("checked",false)}if(e.which==3){checked=false}selector.prop("checked",!checked);check_selected_objects();move_cursor_to(row);return false});kompira.dir_object=$.extend({},kompira.dir_object,{get_selected_objects:get_selected_objects,get_cursored_object:get_cursored_object,get_row_by_abspath:get_row_by_abspath,move_cursor_next:move_cursor_next,move_cursor_prev:move_cursor_prev,toggle_select:toggle_select,toggle_selectall:toggle_selectall});kompira.keybind.on("j",move_cursor_next,gettext("move cursor to next object"),300).on("k",move_cursor_prev,gettext("move cursor to previous object"),300).on(" ",toggle_select,gettext("toggle the object selection"),400).on("a",toggle_selectall,gettext("toggle the all objects selection"),400);kompira.keybind.on("right-click",null,gettext("context-menu"),1e3).on("left-click",null,gettext("select object"),1e3).on("Ctrl + left-click",null,gettext("select multiple objects"),1010);$(document).ready(function(){var params=UTILS.get_url_vars();var contents=$(".dir-contents");var select_objects=params["select_objects"]||contents.data("select_objects");var focus_object=params["focus_object"]||contents.data("focus_object");if("select_all"in params){toggle_selectall()}else if(select_objects){if(typeof select_objects==="string"){select_objects=select_objects.split(",")}else{select_objects=$.map(select_objects,function(s){return s.split(",")})}$.each(select_objects,function(i,select_object){var row=get_row_by_abspath(select_object);row.find(".obj-selector").click()})}if(focus_object){var row=get_row_by_abspath(focus_object);move_cursor_to(row)}check_selected_objects()})})(kompira);(function(kompira){return 0;function focus_search_query(){$(".search-query").focus()}function go_home(){window.location=$(".navbar a.navbar-brand").attr("href")}function go_parent(){var current=window.location.pathname;var path=current.split("/");path.pop();var parent=path.join("/")||"/";window.location=parent+"?focus_object="+current+"&select_objects="+current}function go_prev(){var link=$(".pagination .page-prev").get(0);link&&link.click()}function go_next(){var link=$(".pagination .page-next").get(0);link&&link.click()}kompira.keybind.on("/",focus_search_query,gettext("search"),200).on("~",go_home,gettext("goto home"),600).on("^",go_parent,gettext("goto parent directory"),601).on("Ctrl-Right",go_next,gettext("goto next page"),700).on("Ctrl-Left",go_prev,gettext("goto prev page"),701)})(kompira);(function(kompira){function do_action(method,objpath,action,objects,rename){console.log(action,method,objpath);$("#dir-action-form").attr("action",objpath+"."+action).attr("method",method).find("input[name=action]").val(action).end().find("input[name=objects]").val(objects).end().find("input[name=rename]").val(rename).end().submit()}function rename_object(objpath,newname){console.log("rename_object",objpath,newname);do_action("post",objpath,"rename",objpath,newname)}kompira.dir_action=$.extend({},kompira.dir_action,{rename_object:rename_object})})(kompira);(function(){var params=UTILS.get_url_vars();var cur_order_by=params["order_by"]||$(".dir-contents").data("order_by");$(".header").addClass(function(){var order_by=$(this).data("order_by");if(cur_order_by==order_by){return"headerSortDown"}else if(cur_order_by=="-"+order_by){return"headerSortUp"}return null}).on("click",function(){var new_order_by=$(this).data("order_by");if(cur_order_by==new_order_by){new_order_by="-"+new_order_by}params["order_by"]=new_order_by;window.location.search=jQuery.param(params)})})();(function(){var $context_menu=$(".context-menu");$(document).on("contextmenu",".obj-row",function(e){$context_menu.show().offset({left:e.pageX,top:e.pageY});return false}).on("click",function(e){$context_menu.hide()})})();(function(){var columns_type=$(".column-config").data("columns-type");if(!columns_type){console.error("columns-type not specified");return}if(!localStorage){console.warn("localStorage not supported!")}var store_key="column_hideable_"+columns_type;var hide_columns=load_hide_columns();function column_selector(name){return $('table.column-hideable tr [data-column-name="'+name+'"]')}function load_hide_columns(load_defaults){var columns={};if(load_defaults){$(".column-config .column-show-check").each(function(){var input=$(this);var column_name=input.attr("name");var hidden=input.data("hidden");columns[column_name]=hidden})}else{columns=null;if(localStorage){columns=JSON.parse(localStorage.getItem(store_key))}if(!columns){columns=load_hide_columns(true)}}return columns}function save_hide_columns(){if(localStorage){localStorage.setItem(store_key,JSON.stringify(hide_columns))}}function update_show_columns(){$(".column-config .column-show-check").each(function(){var $input=$(this);var column_name=$input.attr("name");var is_show=!hide_columns[column_name];$input.prop("checked",is_show?"checked":false);column_selector(column_name).toggle(is_show)})}function toggle_show_column(e){var $input=$(this);var column_name=$input.attr("name");var checked=$input.is(":checked");column_selector(column_name).toggle(checked);hide_columns[column_name]=!checked;save_hide_columns()}function reset_to_defaults(){hide_columns=load_hide_columns(true);update_show_columns();save_hide_columns()}$(".column-config").on("change","input.column-show-check",toggle_show_column).on("click",".reset",reset_to_defaults).on("click",".dropdown-menu",function(e){e.stopPropagation()});$(function(){update_show_columns();$("table.column-hideable").show()})})();(function(kompira){var filter_func={any:function(item,index){return true},readable:function(item,index){return item.readable},writable:function(item,index){return item.writable},editable:function(item,index){return item.editable},"property-editable":function(item,index){return item.property_editable},"is-dir":function(item,index){return item.is_dir},disabled:function(item,index){return false}};function update_context(e){var cursored=kompira.dir_object.get_cursored_object();var selected=kompira.dir_object.get_selected_objects();function filter_target(target){var filtered=selected;$.each(target.split(/\s+/),function(i,v){if(v=="cursored"){filtered=cursored?[cursored]:filtered;return true}else if(v=="single"){if(filtered.length!=1){filtered=[];return false}return true}else if(v=="none_or"){if(filtered.length==0){filtered=[true];return false}return true}else if(v){filtered=filtered.filter(filter_func[v]);return filtered.length>0}else{return true}});return filtered}$(".context-enabler").each(function(){var $this=$(this);var target=$this.data("target")||"";var filtered=filter_target(target);if(target)$this.toggleClass("disabled",filtered.length==0)});$("a.context-query").attr("href",function(){var $this=$(this);var target=$this.data("target")||"cursored";var filtered=filter_target(target);return filtered.length?filtered[0]["abspath"]+$this.data("query"):null})}$(document).on("move_cursor.kompira",update_context).on("select_objects.kompira",update_context).on("click",".context-operation",function(e){var $element=$(this);if($element.closest(".disabled").length>0){return}var operation=$element.data("operation");if(operation in kompira.dir_object){var object=$(".dir-contents").data("object");kompira.dir_object[operation](object,$element)}else{console.error("context-operation: '"+operation+"' not in kompira.dir_object")}})})(kompira);(function(kompira){function make_message_obj(objects){var count=objects.length;if(count==1){return interpolate(gettext('an object "%(name)s"'),{name:objects[0].name},true)}else{return interpolate(gettext("%(count)s objects"),{count:count},true)}}function make_message(format,operation,objects){return interpolate(format,{operation:operation,objects:objects},true)}function confirm_dialog(action,objects,title,message,body,btn_label,options){options=$.extend({applicable:true,warning:false,padding:""},options);var $dialog=$("#dir-confirm-dialog");var $form=$dialog.find("form");var objpaths=$.map(objects,function(o){return o.abspath});var $message=$("#dialog-message-tmpl").render({warning:options.warning,message:message});$form.attr("action",action);if(options.uploader){$form.attr("class","uploader")}$dialog.find("#id_dialog-message").html($message);$dialog.find("#id_confirm-options").empty();$dialog.find("button.btn-primary").text(btn_label).prop("disabled",!options.applicable);$dialog.find("button.btn-outline-secondary").prop("disabled",false);$dialog.find("button.close").prop("disabled",false);$dialog.find(".modal-title").text(title);$dialog.find("#confirm-objects").val(objpaths);$dialog.find("#id_dialog-body-contents").css("padding",options.padding).html(body);return $dialog}function mvcp_dialog(action,operation,objects,title,btn_label){var format=gettext("Please select the location where you want to %(operation)s %(objects)s");var message=make_message(format,operation,make_message_obj(objects));var $dtree='<div class="directory-tree" style="height: 300px"></div>';var $dialog=confirm_dialog(action,objects,title,message,$dtree,btn_label,{applicable:false});var $rename=$("#dialog-rename-tmpl").render({rename:objects.length==1?objects[0].name:null});$dialog.find("#id_confirm-options").html($rename);$dialog.one("show.bs.modal",function(){kompira.create_directory_tree(this)});$dialog.one("hidden.bs.modal",function(){kompira.destroy_directory_tree(this)});$dialog.one("ready.directory-tree",function(){$("button.btn-primary",this).prop("disabled",false)});return $dialog}function object_table(objects,warnfunc){var objdata=$.map(objects,function(obj,i){return{number:i+1,object_path:obj.abspath,object_name:obj.name,type_display_name:obj.type_display_name,warning:warnfunc?warnfunc(obj):"",with_warn:!!warnfunc,owner:obj.owner}});var $obj_table=$("#object-table-tmpl").render({objects:objdata,with_warn:!!warnfunc});return $obj_table}function delete_dialog(object){var objects=kompira.dir_object.get_selected_objects();if(objects.length==0){return}var action=object+"."+"delete_objects";var operation=gettext("delete");var format=gettext("Are you sure you want to %(operation)s %(objects)s?");var title=gettext("delete objects");var message=make_message(format,operation,make_message_obj(objects));var $objtbl=object_table(objects,function(o){return o.has_child?gettext("NOT EMPTY!"):""});var btn_label=gettext("delete");var $dialog=confirm_dialog(action,objects,title,message,$objtbl,btn_label,{padding:"0px 20px",warning:true});$dialog.modal("show")}function move_dialog(object){var action=object+"."+"move_objects";var operation=gettext("move");var objects=kompira.dir_object.get_selected_objects();if(objects.length==0){return}var title=gettext("move objects");var btn_label=gettext("move");var $dialog=mvcp_dialog(action,operation,objects,title,btn_label);$dialog.modal("show")}function copy_dialog(object){var action=object+"."+"copy_objects";var operation=gettext("copy");var objects=kompira.dir_object.get_selected_objects();if(objects.length==0){return}var title=gettext("copy objects");var btn_label=gettext("copy");var $dialog=mvcp_dialog(action,operation,objects,title,btn_label);$dialog.modal("show")}function execute_jobflow_dialog(object,context){var action=object+"."+"execute_objects";var objects=kompira.dir_object.get_selected_objects();var format=gettext("Are you sure you want to %(operation)s %(objects)s?");var operation=context.data("relobj");var title=gettext("execute jobflow");var message=make_message(format,operation,make_message_obj(objects));var $objtbl=object_table(objects);var btn_label=gettext("execute");var $dialog=confirm_dialog(action,objects,title,message,$objtbl,btn_label);var $invoker_id=$("<input>").attr({type:"hidden",name:"invoker_id",value:context.data("invoker_id")});$dialog.find("#id_confirm-options").html($invoker_id);$dialog.modal("show")}function execute_form_dialog(object,context){var objects=kompira.dir_object.get_selected_objects();var format=gettext("Are you sure you want to %(operation)s %(objects)s?");var operation=context.data("relobj");var message=make_message(format,operation,make_message_obj(objects));var $message=$("#dialog-message-tmpl").render({message:message});var $objtbl=object_table(objects);var $dialog=$("#dir-execute-form-dialog");var objpaths=$.map(objects,function(o){return o.abspath});var $invoker_id=$("<input>").attr({type:"hidden",name:"invoker_id",value:context.data("invoker_id")});$dialog.find("#id_confirm-options").html($invoker_id);$dialog.find("#id_dialog-message").html($message);$dialog.find("button.btn-primary").prop("disabled",false);$dialog.find("#confirm-objects").val(objpaths);$dialog.find(".object-table").html($objtbl);$dialog.modal("show")}function export_dialog(object){var action=object+"."+"export_objects";var operation=gettext("export");var objects=kompira.dir_object.get_selected_objects();var message_obj;if(objects.length==0){message_obj=interpolate(gettext('all objects under "%(name)s"'),{name:object},true)}else{message_obj=make_message_obj(objects)}var format=gettext("Are you sure you want to %(operation)s %(objects)s?");var title=gettext("export objects");var message=make_message(format,operation,message_obj);var $body=$("#export-dialog-tmpl").render({});var btn_label=gettext("export");var $dialog=confirm_dialog(action,objects,title,message,$body,btn_label);if(objects.length>0){var $objtbl=object_table(objects);$dialog.find("#id_dialog-body-contents").append("<hr>").append($objtbl)}$dialog.find("button.close").prop("disabled",false);$dialog.find("button.btn-primary").one("click",function(e){$dialog.modal("hide")});$dialog.find("button.btn-outline-secondary").prop("disabled",false);$dialog.modal("show")}function import_dialog(object){var action=object+"."+"import_objects";var operation=gettext("import");var objects=kompira.dir_object.get_selected_objects();var format=gettext("Please select a file to %(operation)s into %(objects)s");var message_obj;if(objects.length==0){message_obj=interpolate(gettext('an object "%(name)s"'),{name:object},true)}else{message_obj=make_message_obj(objects)}var title=gettext("import objects");var message=make_message(format,operation,message_obj);var $body=$("#import-dialog-tmpl").render({});var btn_label=gettext("import");var $dialog=confirm_dialog(action,objects,title,message,$body,btn_label,{uploader:true});var $input=$dialog.find("#id_import_file");$input.val("");$input.bind("change",kompira.check_upload);$input.bind("change",function(e){$("button.btn-primary",$dialog).prop("disabled",!$(this).val())});kompira.uploader(true);$dialog.find("button.close").prop("disabled",false);$dialog.find("button.btn-primary").prop("disabled",true);$dialog.find("button.btn-outline-secondary").prop("disabled",false);$dialog.bind("submit",function(){var submit_buttons=$(this).find("button");submit_buttons.prop("disabled",true);$dialog.modal("hide")});var $overwrite=$dialog.find("input#id_overwrite");var $update_conf=$dialog.find("input#id_update_conf");$overwrite.bind("click",function(){var disable=!$(this).is(":checked");if(disable){$update_conf.prop("checked",false)}$update_conf.attr("disabled",disable)});$dialog.modal("show")}function edit_property(object){var objects=kompira.dir_object.get_selected_objects();if(objects.length==1){var[obj]=objects;window.location.href=obj.abspath+".property"}else if(objects.length>1){var operation=gettext("edit property");var format=gettext("Edit properties of %(objects)s");var message=make_message(format,operation,make_message_obj(objects));var $dialog=$("#dir-property-dialog");var objpaths=$.map(objects,function(o){return o.abspath});var $message=$("#dialog-message-tmpl").render({message:message});$dialog.find("#id_dialog-message").html($message);$dialog.find("#property-objects").val(objpaths);$dialog.find("form.prevent-double-submit").bind("submit",function(){var submit_buttons=$(this).find("button");submit_buttons.prop("disabled",true)});$dialog.modal("show")}}kompira.dir_object=$.extend({},kompira.dir_object,{delete_dialog:delete_dialog,move_dialog:move_dialog,copy_dialog:copy_dialog,execute_jobflow_dialog:execute_jobflow_dialog,execute_form_dialog:execute_form_dialog,export_dialog:export_dialog,import_dialog:import_dialog,edit_property:edit_property});$("#id_import_file").on("change",function(e){if($(this).val()){$("#dir-import-dialog .btn-primary").prop("disabled",false)}else{$("#dir-import-dialog .btn-primary").prop("disabled",true)}});kompira.keybind.on("Delete",function(e){var object=$(".dir-contents").data("object");delete_dialog(object)},gettext("delete objects"),500).on("m",function(e){var object=$(".dir-contents").data("object");move_dialog(object)},gettext("move objects"),500).on("c",function(e){var object=$(".dir-contents").data("object");copy_dialog(object)},gettext("copy objects"),500).on("p",function(e){var object=$(".dir-contents").data("object");edit_property(object)},gettext("edit property"),500)})(kompira);(function(kompira){function create_directory_tree(dialog){var pathname=decodeURIComponent(window.location.pathname);var node_list=create_node_list(pathname.replace(/\.([.\w])+$/,""));var $tree=$(".directory-tree",dialog);$tree.jstree({core:{data:directory_data_loader(node_list),check_callback:true,multiple:false,themes:{responsive:false}},plugins:["wholerow","ui"]}).on("load_node.jstree",function(e,obj){node=node_list.shift();if(node){var next_node=obj.instance.get_node(node);if(!next_node){obj.instance.create_node(obj.node,{id:node,text:path_to_name(node),state:{opened:true,disabled:true},children:true})}obj.instance.load_node(node)}else{obj.instance.deselect_all(true);obj.instance.open_node(obj.node);obj.instance.select_node(obj.node);$tree.trigger("ready.directory-tree")}}).on("select_node.jstree",function(e,obj){$tree.trigger("select.directory-tree",obj.node.id);$("#selected-object",dialog).val(obj.node.id)}).on("ready.directory-tree",function(e){var selected=$(".jstree-clicked",dialog);if(selected.length){var modal_body=$(".modal-body",dialog);var selected_top=selected.position().top;var selected_bottom=selected_top+selected.height();var viewport_top=modal_body.scrollTop();var viewport_bottom=viewport_top+modal_body.height();var top;if(selected_top<viewport_top){top=selected_top}else if(selected_bottom>=viewport_bottom){top=selected_bottom-modal_body.height()}else{return}modal_body.scrollTop(top)}})}function destroy_directory_tree(dialog){$(".directory-tree",dialog).trigger("abort.directory-tree").off(".directory-tree .jstree").jstree("destroy").empty()}function path_to_name(path){return path.split("/").pop()||"/"}function node_text(obj){var name=path_to_name(obj.abspath);var display_name=obj.display_name;if(name==display_name){return name}else if(display_name){name=interpolate('<span class="alt-name"><span>%(name)s</span><span>(%(display_name)s)</span></span>',{name:name,display_name:display_name},true)}return name}function directory_data_loader(node_list){return function(node,callback){var url;if(node.id==="#"){url="/"}else if(node.state.disabled){url=node.id}else{url=node.id+".children"}url=$.map(url.split("/"),function(path){return encodeURIComponent(path)}).join("/");var req=$.ajax({url:url,data:{type_object__in:["/system/types/Directory","/system/types/Table"],attrs:["name","abspath","display_name","parent_object","type_object","extra_properties"],no_pagination:true},traditional:true}).done(function(data){if(!$.isArray(data)){data=[data]}var new_nodes=[];$.each(data,function(i,obj){new_nodes.push({id:obj.abspath,icon:"jstree-folder",text:node_text(obj),parent:obj.abspath==="/"?"#":obj.parent_object,children:!!obj.extra_properties.num_children});return true});if(node.state.disabled){node.state.disabled=false;node.text=node_text(data[0]);node_list.unshift(node.id);callback([])}else{callback(new_nodes)}}).fail(function(e){var status="("+e.statusText.toLowerCase()+")";node.state={opened:true,disabled:true};node.text+=" "+status;callback([])})}}function create_node_list(pathname){var pathnames=pathname.split("/");var node_list=[];for(i=1;i<pathnames.length;i++){node_list.push(pathnames.slice(0,i+1).join("/"))}if(node_list[0]!="/"){node_list.unshift("/")}return node_list}kompira.create_directory_tree=create_directory_tree;kompira.destroy_directory_tree=destroy_directory_tree})(kompira);
